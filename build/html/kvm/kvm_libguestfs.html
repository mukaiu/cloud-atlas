<!DOCTYPE html>
<html class="writer-html5" lang="zh" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ä½¿ç”¨libguestfsä¿®è®¢KVMé•œåƒ &mdash; Cloud Atlas: Discovery beta æ–‡æ¡£</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />

  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=8534f863"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="ç´¢å¼•" href="../genindex.html" />
    <link rel="search" title="æœç´¢" href="../search.html" />
    <link rel="copyright" title="ç‰ˆæƒæ‰€æœ‰" href="../copyright.html" />
    <link rel="next" title="KVMçš„GPUç›´é€šè™šæ‹ŸåŒ–" href="gpu_passthrough_with_kvm.html" />
    <link rel="prev" title="åŸºäºQEMU+Dockerä½¿ç”¨Tesla T10" href="qemu/qemu_docker_tesla_t10.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Cloud Atlas: Discovery
          </a>
              <div class="version">
                1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="æœç´¢æ–‡æ¡£" aria-label="æœç´¢æ–‡æ¡£" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="å¯¼èˆªèœå•">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../studio/index.html">Studio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/index.html">Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devops/index.html">DevOps</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">KVM</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="install/index.html">KVM ç¯å¢ƒå®‰è£…</a></li>
<li class="toctree-l2"><a class="reference internal" href="startup/index.html">KVM å¿«é€Ÿèµ·æ­¥</a></li>
<li class="toctree-l2"><a class="reference internal" href="hypervisor.html">hypervisor</a></li>
<li class="toctree-l2"><a class="reference internal" href="qemu_vs_kvm.html">QEMU v. KVM</a></li>
<li class="toctree-l2"><a class="reference internal" href="storage/index.html">KVM å­˜å‚¨</a></li>
<li class="toctree-l2"><a class="reference internal" href="libvirt/index.html">Libvirtè™šæ‹Ÿæœºç®¡ç†å™¨</a></li>
<li class="toctree-l2"><a class="reference internal" href="remote_desktop/index.html">è¿œç¨‹æ¡Œé¢</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance/index.html">KVM æ€§èƒ½ä¼˜åŒ–</a></li>
<li class="toctree-l2"><a class="reference internal" href="memory/index.html">KVMå†…å­˜ç®¡ç†</a></li>
<li class="toctree-l2"><a class="reference internal" href="numa/index.html">KVM NUMA</a></li>
<li class="toctree-l2"><a class="reference internal" href="intel_vt/index.html">Intel VT(Virtualization Technology)</a></li>
<li class="toctree-l2"><a class="reference internal" href="iommu/index.html">IOMMU</a></li>
<li class="toctree-l2"><a class="reference internal" href="intel_gvt/index.html">Intel GVT GPUè™šæ‹ŸåŒ–</a></li>
<li class="toctree-l2"><a class="reference internal" href="vgpu/index.html">NVIDIA Virtual GPU (vGPU)</a></li>
<li class="toctree-l2"><a class="reference internal" href="hardware_virtual.html">ç¡¬ä»¶è™šæ‹ŸåŒ–</a></li>
<li class="toctree-l2"><a class="reference internal" href="kvm_nested_virtual/index.html">KVMåµŒå¥—è™šæ‹ŸåŒ–</a></li>
<li class="toctree-l2"><a class="reference internal" href="kvm_vdisk_live.html">KVMè™šæ‹ŸæœºåŠ¨æ€æ·»åŠ ã€è°ƒæ•´ç£ç›˜</a></li>
<li class="toctree-l2"><a class="reference internal" href="kvm_live_migration.html">KVMçƒ­è¿ç§»</a></li>
<li class="toctree-l2"><a class="reference internal" href="qemu/index.html">QEMU</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">ä½¿ç”¨libguestfsä¿®è®¢KVMé•œåƒ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kpartx">kpartxå·¥å…·</a></li>
<li class="toctree-l3"><a class="reference internal" href="#libguestfs">libguestfså·¥å…·</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">libguestfsæ¦‚å¿µ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">å®‰è£…</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#red-hat-centos">Red Hat/CentOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ubuntu-debian">Ubuntu/Debian</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id3">ä½¿ç”¨</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#guestfish-shell"><code class="docutils literal notranslate"><span class="pre">guestfish</span></code> SHELL</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id6">å‚è€ƒ</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gpu_passthrough_with_kvm.html">KVMçš„GPUç›´é€šè™šæ‹ŸåŒ–</a></li>
<li class="toctree-l2"><a class="reference internal" href="nvidia_cuda_gpu_in_kvm.html">åœ¨KVMä¸­ä½¿ç”¨NVIDIA CUDA GPU</a></li>
<li class="toctree-l2"><a class="reference internal" href="amd_rocm_gpu_in_kvm.html">åœ¨KVMä¸­ä½¿ç”¨AMD ROCm GPU</a></li>
<li class="toctree-l2"><a class="reference internal" href="amd_kvm/index.html">AMDç¡¬ä»¶ç¯å¢ƒKVMè™šæ‹ŸåŒ–</a></li>
<li class="toctree-l2"><a class="reference internal" href="arm_kvm/index.html">ARMç¡¬ä»¶ç¯å¢ƒKVMè™šæ‹ŸåŒ–</a></li>
<li class="toctree-l2"><a class="reference internal" href="debug/index.html">KVMæ•…éšœæ’æŸ¥</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ceph/index.html">Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gluster/index.html">Gluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ovirt/index.html">oVirt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openstack/index.html">OpenStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/index.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes/index.html">Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../k8s_dev/index.html">Kubernetes Develop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rancher/index.html">Rancher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openshift/index.html">OpenShift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql/index.html">SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sqlite/index.html">SQLite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mysql/index.html">MySQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pgsql/index.html">PostgreSQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nosql/index.html">NoSQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/index.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infra_service/index.html">Infra-Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infra_search/index.html">Infra-Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web/index.html">Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="../info_service/index.html">Info-Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../big_data/index.html">Big Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../machine_learning/index.html">Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../drone/index.html">Drone</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linux/index.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel/index.html">Kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance/index.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distributed_system/index.html">Distributed System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/index.html">Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../django/index.html">Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/index.html">JavaScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nodejs/index.html">Node.js</a></li>
<li class="toctree-l1"><a class="reference internal" href="../clang/index.html">C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../golang/index.html">Go</a></li>
<li class="toctree-l1"><a class="reference internal" href="../swift/index.html">Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rust/index.html">Rust</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ruby/index.html">Ruby</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lua/index.html">Lua</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arm/index.html">ARM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../raspberry_pi/index.html">Raspberry Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../android/index.html">Android</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bsd/index.html">BSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../freebsd/index.html">FreeBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apple/index.html">Apple</a></li>
<li class="toctree-l1"><a class="reference internal" href="../windows/index.html">Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../real/index.html">Real</a></li>
<li class="toctree-l1"><a class="reference internal" href="../management/index.html">Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../life/index.html">Life</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aboutme.html">å…³äºä½œè€…</a></li>
<li class="toctree-l1"><a class="reference internal" href="../donate.html">æèµ </a></li>
<li class="toctree-l1"><a class="reference internal" href="../thanks.html">æ„Ÿè°¢</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index.html">é™„å½•</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="ç§»åŠ¨ç‰ˆå¯¼èˆªèœå•" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Cloud Atlas: Discovery</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="é¡µé¢å¯¼èˆª">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">KVM</a></li>
      <li class="breadcrumb-item active">ä½¿ç”¨libguestfsä¿®è®¢KVMé•œåƒ</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/kvm/kvm_libguestfs.rst.txt" rel="nofollow"> æŸ¥çœ‹é¡µé¢æºç </a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="libguestfskvm">
<span id="kvm-libguestfs"></span><h1>ä½¿ç”¨libguestfsä¿®è®¢KVMé•œåƒ<a class="headerlink" href="#libguestfskvm" title="Link to this heading">ïƒ</a></h1>
<p>åœ¨äº‘è®¡ç®—ä¸­ï¼Œæˆ‘ä»¬ä¼šæŠŠç²¾å¿ƒé…ç½®çš„è™šæ‹Ÿæœºåˆ¶ä½œæˆæ¨¡ç‰ˆï¼Œç„¶åé€šè¿‡æ¨¡ç‰ˆå¤åˆ¶å‡ºå¤§é‡çš„è™šæ‹Ÿæœºæ¥æ„å»ºé›†ç¾¤ã€‚ä½†æ˜¯ï¼Œæ¯ä¸ªè™šæ‹Ÿæœºå†…éƒ¨æœ‰ä¸€äº›ä¸å¾—ä¸ä¸€ä¸€å®šåˆ¶çš„é…ç½®ï¼Œéœ€è¦æœ‰ä¸€ä¸ªç»Ÿä¸€å·¥å…·æ¥å®Œæˆä¿®è®¢ã€‚</p>
<section id="kpartx">
<h2>kpartxå·¥å…·<a class="headerlink" href="#kpartx" title="Link to this heading">ïƒ</a></h2>
<p>æ—©æœŸRed Hat Linux 5å‘è¡Œç‰ˆéƒ½ä¼šæä¾›ä¸€ä¸ª <code class="docutils literal notranslate"><span class="pre">kpartx</span></code> å·¥å…·ï¼Œå¯ä»¥å°†è™šæ‹Ÿæœºæ–‡ä»¶ç³»ç»Ÿä½œä¸ºä¸€ä¸ªloopè®¾å¤‡ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ç‰©ç†æœåŠ¡å™¨ä¸Šè®¿é—®ã€‚</p>
<div class="admonition warning">
<p class="admonition-title">è­¦å‘Š</p>
<ul class="simple">
<li><p>RHEL/CentOS 6å’Œ7ä»¥åï¼Œè¯·ä¸è¦ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">kpartx</span></code> ï¼Œæ”¹ä¸ºä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">guestfish</span></code> å·¥å…·</p></li>
<li><p>åœ¨ç‰©ç†æœåŠ¡å™¨ä¸Šä¿®æ”¹è™šæ‹Ÿæœºç£ç›˜ï¼Œä¸€å®šè¦åœ¨è™šæ‹ŸæœºofflineçŠ¶æ€ä¸‹æ‰å¯ä»¥æ“ä½œ</p></li>
</ul>
</div>
<ul>
<li><p>ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">kpartx</span></code> åˆ—å‡ºåˆ†åŒºè®¾å¤‡æ˜ å°„åˆ°åŸºäºå­˜å‚¨é•œåƒçš„æ–‡ä»¶ï¼Œä»¥ä¸‹æ¡ˆä¾‹ä½¿ç”¨çš„æ˜ åƒæ–‡ä»¶æ˜¯ <code class="docutils literal notranslate"><span class="pre">guest1.img</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kpartx</span> <span class="o">-</span><span class="n">l</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libvirt</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">guest1</span><span class="o">.</span><span class="n">img</span>
</pre></div>
</div>
</li>
</ul>
<p>æ˜¾ç¤ºè¾“å‡º:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">loop0p1</span> <span class="p">:</span> <span class="mi">0</span> <span class="mi">409600</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">loop0</span> <span class="mi">63</span>
<span class="n">loop0p2</span> <span class="p">:</span> <span class="mi">0</span> <span class="mi">10064717</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">loop0</span> <span class="mi">409663</span>
</pre></div>
</div>
<ul>
<li><p>æ·»åŠ åˆ†åŒºæ˜ åƒåˆ° <code class="docutils literal notranslate"><span class="pre">/dev/mapper/</span></code> ä¸‹è®¾å¤‡:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kpartx</span> <span class="o">-</span><span class="n">a</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libvirt</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">guest1</span><span class="o">.</span><span class="n">img</span>
</pre></div>
</div>
</li>
<li><p>æ£€æŸ¥ç£ç›˜åˆ†åŒºæ˜ å°„:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">mapper</span><span class="o">/</span>
</pre></div>
</div>
</li>
</ul>
<p>å¯ä»¥çœ‹åˆ°æŒ‚è½½çš„åˆ†åŒºè®¾å¤‡:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">loop0p1</span>
<span class="n">loop0p2</span>
</pre></div>
</div>
<ul>
<li><p>ç„¶åå°±å¯ä»¥ä½¿ç”¨ç›®å½•æ¥loopè®¾å¤‡ï¼Œå¦‚æœéœ€è¦åˆ™åˆ›å»ºç›®å½•:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">guest1</span>
<span class="n">mount</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">mapper</span><span class="o">/</span><span class="n">loop0p1</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">guest1</span> <span class="o">-</span><span class="n">o</span> <span class="n">loop</span><span class="p">,</span><span class="n">rw</span>
</pre></div>
</div>
</li>
<li><p>å®Œæˆé•œåƒçš„æ–‡ä»¶ç³»ç»Ÿä¿®æ”¹ä¹‹åï¼Œå¯ä»¥å»é™¤åˆ†åŒºæ˜ å°„çš„é•œåƒæ–‡ä»¶è¿æ¥:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kpartx</span> <span class="o">-</span><span class="n">d</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libvirt</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">guest1</span><span class="o">.</span><span class="n">img</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="libguestfs">
<h2>libguestfså·¥å…·<a class="headerlink" href="#libguestfs" title="Link to this heading">ïƒ</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">libguestfs</span></code> æ˜¯ç°ä»£Linuxå‘è¡Œç‰ˆæä¾›çš„è™šæ‹Ÿæœºé•œåƒè®¿é—®å·¥å…·:</p>
<ul class="simple">
<li><p>æŸ¥çœ‹æˆ–ä¸‹è½½ä½äºè™šæ‹Ÿæœºç£ç›˜ä¸­çš„æ–‡ä»¶</p></li>
<li><p>ç¼–è¾‘æˆ–ä¸Šä¼ è™šæ‹Ÿæœºç£ç›˜ä¸­çš„æ–‡ä»¶</p></li>
<li><p>è¯»å†™è™šæ‹Ÿæœºé…ç½®</p></li>
<li><p>å‡†å¤‡æ–°ç£ç›˜é•œåƒåŒ…å«æ–‡ä»¶ã€ç›®å½•ã€æ–‡ä»¶ç³»ç»Ÿã€åˆ†åŒºã€é€»è¾‘å·å’Œå…¶ä»–</p></li>
<li><p>ç´§æ€¥æ•‘æ´æˆ–ä¿®å¤guestè™šæ‹Ÿæœºå¯åŠ¨æ•…éšœæˆ–å…¶ä»–éœ€è¦ä¿®æ”¹å¯åŠ¨é…ç½®</p></li>
<li><p>ç›‘æ§è™šæ‹Ÿæœºçš„ç£ç›˜ä½¿ç”¨</p></li>
<li><p>å®¡è®¡guestè™šæ‹Ÿæœºçš„ç¬¦åˆç»„ç»‡å®‰å…¨æ ‡å‡†æƒ…å†µ</p></li>
<li><p>é€šè¿‡å…‹éš†æˆ–ä¿®æ”¹æ¨¡æ¿æ¥éƒ¨ç½²guestè™šæ‹Ÿæœº</p></li>
<li><p>è¯»å–CD/DVD ISOæˆ–è½¯ç›˜ç£ç›˜é•œåƒ</p></li>
</ul>
</section>
<section id="id1">
<h2>libguestfsæ¦‚å¿µ<a class="headerlink" href="#id1" title="Link to this heading">ïƒ</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">libguestfs</span> <span class="pre">(GUEST</span> <span class="pre">FileSystem</span> <span class="pre">LIBrary)</span></code> - åº•å±‚Cåº“æä¾›äº†åŸºæœ¬ç‚¹æ‰“å¼€ç£ç›˜é•œåƒï¼Œè¯»å–å’Œå†™å…¥æ–‡ä»¶ç­‰ç­‰åŸºæœ¬åŠŸèƒ½ã€‚å¯ä»¥ç¼–å†™Cç¨‹åºæ¥è®¿é—®API</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">guestfish</span> <span class="pre">(GUEST</span> <span class="pre">Filesystem</span> <span class="pre">Interactive</span> <span class="pre">SHell</span></code> - äº¤äº’çš„shellç”¨äºåœ¨å‘½ä»¤è¡Œæˆ–è€…shellè„šæœ¬ä½¿ç”¨ã€‚ <code class="docutils literal notranslate"><span class="pre">guestfish</span></code> è¾“å‡ºäº†libguestfs APIæ‰€æœ‰çš„åŠŸèƒ½ã€‚</p></li>
<li><p>è®¸å¤švirtå·¥å…·éƒ½åŸºäº <code class="docutils literal notranslate"><span class="pre">libguestfs</span></code> ï¼Œæä¾›äº†æ‰§è¡Œç‰¹å®šå•ä¸€ä»»åŠ¡çš„å‘½ä»¤è¡Œæ–¹æ³•ã€‚å·¥å…·åŒ…æ‹¬ <code class="docutils literal notranslate"><span class="pre">virt-df</span></code> ï¼Œ <code class="docutils literal notranslate"><span class="pre">virt-rescue</span></code> ï¼Œ <code class="docutils literal notranslate"><span class="pre">virt-resize</span></code> å’Œ <code class="docutils literal notranslate"><span class="pre">virt-edit</span></code> ã€‚</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">augeas</span></code> æ˜¯ç”¨äºç¼–è¾‘Linuxé…ç½®æ–‡ä»¶çš„åº“ï¼Œè™½ç„¶è¿™ä¸ªåº“å’Œ <code class="docutils literal notranslate"><span class="pre">libguestfs</span></code> æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œä½†æ˜¯å¾ˆå¤š <code class="docutils literal notranslate"><span class="pre">libguestfs</span></code> éƒ½ç»“åˆäº†è¿™ä¸ªå·¥å…·ã€‚</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">guestmount</span></code> æ˜¯ä¸€ä¸ªç»“åˆ <code class="docutils literal notranslate"><span class="pre">libguestfs</span></code> å’Œ <code class="docutils literal notranslate"><span class="pre">FUSE</span></code> çš„æ¥å£ï¼Œä¸»è¦ç”¨äºåœ¨ç‰©ç†æœåŠ¡å™¨ä¸ŠæŒ‚è½½ç£ç›˜é•œåƒçš„æ–‡ä»¶ç³»ç»Ÿã€‚è¿™ä¸ªåŠŸèƒ½ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æ˜¯éå¸¸æœ‰ç”¨ã€‚</p></li>
</ul>
</section>
<section id="id2">
<h2>å®‰è£…<a class="headerlink" href="#id2" title="Link to this heading">ïƒ</a></h2>
<section id="red-hat-centos">
<h3>Red Hat/CentOS<a class="headerlink" href="#red-hat-centos" title="Link to this heading">ïƒ</a></h3>
<ul>
<li><p><a class="reference internal" href="../linux/redhat_linux/index.html#redhat-linux"><span class="std std-ref">RedHat Linux</span></a> å®‰è£…:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">dnf</span> <span class="n">install</span> <span class="n">libguestfs</span> <span class="n">libguestfs</span><span class="o">-</span><span class="n">tools</span> <span class="n">libguestfs</span><span class="o">-</span><span class="n">winsupport</span>
</pre></div>
</div>
</li>
<li><p>è¦å®‰è£… <code class="docutils literal notranslate"><span class="pre">libguestfs</span></code> ç›¸å…³è½¯ä»¶åŒ…ï¼ŒåŒ…æ‹¬è¯­è¨€ç»‘å®šï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">dnf</span> <span class="n">install</span> <span class="s2">&quot;*guestf*&quot;</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="ubuntu-debian">
<h3>Ubuntu/Debian<a class="headerlink" href="#ubuntu-debian" title="Link to this heading">ïƒ</a></h3>
<ul>
<li><p>Debianç³»å‘è¡Œç‰ˆå®‰è£…:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">libguestfs</span><span class="o">-</span><span class="n">tools</span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>
<section id="id3">
<h2>ä½¿ç”¨<a class="headerlink" href="#id3" title="Link to this heading">ïƒ</a></h2>
<section id="guestfish-shell">
<h3><code class="docutils literal notranslate"><span class="pre">guestfish</span></code> SHELL<a class="headerlink" href="#guestfish-shell" title="Link to this heading">ïƒ</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">guestfish</span></code> æ˜¯å‘½ä»¤è¡Œæˆ–è€…shellè„šæœ¬ä¸­ç”¨äºè®¿é—®guestè™šæ‹Ÿæœºæ–‡ä»¶ç³»ç»Ÿçš„äº¤äº’shellã€‚è¿™ä¸ªshellæä¾›äº†æ‰€æœ‰ <code class="docutils literal notranslate"><span class="pre">libguestfs</span></code> APIçš„åŠŸèƒ½ã€‚</p>
<ul>
<li><p>è¦æŸ¥çœ‹è™šæ‹Ÿæœºç£ç›˜é•œåƒï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">guestfish</span> <span class="o">--</span><span class="n">ro</span> <span class="o">-</span><span class="n">a</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libvirt</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">centos6</span><span class="o">.</span><span class="n">img</span>
</pre></div>
</div>
</li>
</ul>
<p>è¿™é‡Œ <code class="docutils literal notranslate"><span class="pre">--ro</span> <span class="pre">``</span> <span class="pre">è¡¨ç¤ºä»¥åªè¯»æ–¹å¼æ‰“å¼€ç£ç›˜é•œåƒã€‚è¿™ä¸ªæ¨¡å¼æ€»æ˜¯å®‰å…¨çš„ä½†æ˜¯ä¸å…è®¸å†™å…¥æ“ä½œã€‚åªæœ‰åœ¨</span> <span class="pre">``ç¡®å®š</span></code> guestè™šæ‹Ÿæœºæ²¡æœ‰è¿è¡Œæˆ–ç£ç›˜é•œåƒæ²¡æœ‰è¿æ¥åˆ°è¿è¡Œä¸­çš„guestè™šæ‹Ÿæœºæ—¶æ‰å¯ä»¥çœç•¥è¿™ä¸ªå‚æ•°ã€‚ <code class="docutils literal notranslate"><span class="pre">ç»ä¸å¯ä»¥</span></code> ä½¿ç”¨libguestfsæ¥ç¼–è¾‘è¿è¡Œä¸­guestè™šæ‹Ÿæœºï¼Œå¦åˆ™ä¼šå¯¼è‡´ä¸å¯é€†è½¬çš„è™šæ‹Ÿç£ç›˜æŸåã€‚</p>
<div class="admonition note">
<p class="admonition-title">å¤‡æ³¨</p>
<p><code class="docutils literal notranslate"><span class="pre">libguestfs</span></code> å’Œ <code class="docutils literal notranslate"><span class="pre">guestfish</span></code> ä¸éœ€è¦rootæƒé™ï¼Œåªéœ€è¦ç¡®ä¿ç£ç›˜é•œåƒå…·æœ‰è¯»å†™æƒé™å³å¯ã€‚</p>
</div>
<p>ä¸Šè¿°äº¤äº’æ¨¡å¼å¯åŠ¨ <code class="docutils literal notranslate"><span class="pre">guestfish</span></code> ä¼šæç¤º:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Welcome</span> <span class="n">to</span> <span class="n">guestfish</span><span class="p">,</span> <span class="n">the</span> <span class="n">guest</span> <span class="n">filesystem</span> <span class="n">shell</span> <span class="k">for</span>
<span class="n">editing</span> <span class="n">virtual</span> <span class="n">machine</span> <span class="n">filesystems</span> <span class="ow">and</span> <span class="n">disk</span> <span class="n">images</span><span class="o">.</span>

<span class="n">Type</span><span class="p">:</span> <span class="s1">&#39;help&#39;</span> <span class="k">for</span> <span class="n">help</span> <span class="n">on</span> <span class="n">commands</span>
      <span class="s1">&#39;man&#39;</span> <span class="n">to</span> <span class="n">read</span> <span class="n">the</span> <span class="n">manual</span>
      <span class="s1">&#39;quit&#39;</span> <span class="n">to</span> <span class="n">quit</span> <span class="n">the</span> <span class="n">shell</span>

<span class="o">&gt;&lt;</span><span class="n">fs</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>åœ¨è¿™ä¸ªæç¤ºç¬¦ä¸‹ï¼Œè¾“å…¥ <code class="docutils literal notranslate"><span class="pre">run</span></code> å‘½ä»¤æ¥åˆå§‹åŒ–åº“ä»¥åŠè¿æ¥ç£ç›˜é•œåƒã€‚é¦–æ¬¡è¿è¡Œå¯èƒ½ä¼šèŠ±è´¹30ç§’é’Ÿæ—¶é—´ï¼Œåç»­åˆ™å®Œæˆå¿«å¾ˆå¤šã€‚</p>
<div class="admonition note">
<p class="admonition-title">å¤‡æ³¨</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">libguestfs</span></code> ä½¿ç”¨ç¡¬ä»¶è™šæ‹ŸåŒ–åŠ é€Ÿï¼Œä¾‹å¦‚KVM(å¦‚æœæœ‰çš„è¯)æ¥åŠ é€Ÿå¤„ç†è¿›ç¨‹ã€‚</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">guestfish</span></code> çš„æç¤ºç¬¦æ˜¯ <code class="docutils literal notranslate"><span class="pre">&gt;&lt;fs&gt;</span></code> ï¼Œåç»­æ¡ˆä¾‹ä¸­ï¼Œè¿™ä¸ªæç¤ºç¬¦è¯·ä¸è¦åœ¨å‘½ä»¤è¡Œè¾“å…¥ï¼Œåªè¡¨ç¤ºè¯¥è¡Œæ˜¯è¾“å…¥çš„å‘½ä»¤ã€‚</p></li>
</ul>
</div>
<p>ä¸€æ—¦ <code class="docutils literal notranslate"><span class="pre">run</span></code> å‘½ä»¤æ‰§è¡Œå®Œæˆï¼Œå…¶ä»–å‘½ä»¤å°±å¯ä»¥ä½¿ç”¨ã€‚</p>
<section id="guestfish">
<h4>ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">guestfish</span></code> æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿ<a class="headerlink" href="#guestfish" title="Link to this heading">ïƒ</a></h4>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">list-filesystems</span></code> å°†åˆ—å‡º <code class="docutils literal notranslate"><span class="pre">libguestfs</span></code> æ‰¾åˆ°çš„æ–‡ä»¶ç³»ç»Ÿ:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="o">-</span><span class="n">filesystems</span>
</pre></div>
</div>
</li>
</ul>
<p>æ˜¾ç¤º:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda1</span><span class="p">:</span> <span class="n">ext4</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vg_centos6</span><span class="o">/</span><span class="n">lv_root</span><span class="p">:</span> <span class="n">ext4</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vg_centos6</span><span class="o">/</span><span class="n">lv_swap</span><span class="p">:</span> <span class="n">swap</span>
</pre></div>
</div>
<p>å…¶ä»–æœ‰ç”¨çš„å‘½ä»¤æ˜¯ <code class="docutils literal notranslate"><span class="pre">list-devices</span></code> ï¼Œ <code class="docutils literal notranslate"><span class="pre">list-partitions</span></code> ï¼Œ <code class="docutils literal notranslate"><span class="pre">lvs</span></code> ï¼Œ <code class="docutils literal notranslate"><span class="pre">pvs</span></code> ï¼Œ <code class="docutils literal notranslate"><span class="pre">vfs-type</span></code> å’Œ <code class="docutils literal notranslate"><span class="pre">file</span></code> ã€‚å¯ä»¥é€šè¿‡ <code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">COMMAND</span></code> æ¥æŸ¥çœ‹è¯¦ç»†çš„å¸®åŠ©:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&lt;</span><span class="n">fs</span><span class="o">&gt;</span> <span class="nb">list</span><span class="o">-</span><span class="n">devices</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda</span>

<span class="o">&gt;&lt;</span><span class="n">fs</span><span class="o">&gt;</span> <span class="nb">list</span><span class="o">-</span><span class="n">partitions</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda1</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda2</span>

<span class="o">&gt;&lt;</span><span class="n">fs</span><span class="o">&gt;</span> <span class="n">lvs</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vg_centos6</span><span class="o">/</span><span class="n">lv_root</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vg_centos6</span><span class="o">/</span><span class="n">lv_swap</span>

<span class="o">&gt;&lt;</span><span class="n">fs</span><span class="o">&gt;</span> <span class="n">pvs</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda2</span>

<span class="o">&gt;&lt;</span><span class="n">fs</span><span class="o">&gt;</span> <span class="n">vfs</span><span class="o">-</span><span class="nb">type</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda1</span>
<span class="n">ext4</span>

<span class="o">&gt;&lt;</span><span class="n">fs</span><span class="o">&gt;</span> <span class="n">vfs</span><span class="o">-</span><span class="nb">type</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda2</span>
<span class="n">LVM2_member</span>
</pre></div>
</div>
<p>è¦æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„å®é™…å†…å®¹ï¼Œè¯¥æ–‡ä»¶ç³»ç»Ÿå¿…é¡»è¢«æŒ‚è½½ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">guestfish</span></code> å‘½ä»¤å¦‚ <code class="docutils literal notranslate"><span class="pre">ls</span></code> ï¼Œ <code class="docutils literal notranslate"><span class="pre">ll</span></code> ï¼Œ <code class="docutils literal notranslate"><span class="pre">cat</span></code> ç­‰</p>
<div class="admonition note">
<p class="admonition-title">å¤‡æ³¨</p>
<p>åœ¨ <code class="docutils literal notranslate"><span class="pre">guestfish</span></code> ä¸­æ²¡æœ‰å½“å‰å·¥ä½œç›®å½•è¿™ä¸ªæ¦‚å¿µã€‚å’ŒåŸå§‹çš„shellä¸åŒï¼Œä¸èƒ½ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">cd</span></code> å‘½ä»¤æ›´æ”¹ç›®å½•ã€‚æ‰€æœ‰è·¯å¾„å¿…é¡»æ˜¯ä»é¡¶éƒ¨å¼€å§‹å¸¦æœ‰ä¸€ä¸ª <code class="docutils literal notranslate"><span class="pre">/</span></code> å­—ç¬¦çš„ <strong>å®Œå…¨è·¯å¾„</strong> ã€‚å¯ä»¥ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">TAB</span></code> é”®æ¥è¡¥å®Œè·¯å¾„ã€‚</p>
</div>
<p>è¦é€€å‡º <code class="docutils literal notranslate"><span class="pre">guestfish</span></code>  ï¼Œå¯ä»¥è¾“å…¥ <code class="docutils literal notranslate"><span class="pre">exit</span></code> æˆ–è€… <code class="docutils literal notranslate"><span class="pre">Ctrl+d</span></code> ã€‚</p>
</section>
<section id="guestfish-inspection">
<h4>é€šè¿‡ <code class="docutils literal notranslate"><span class="pre">guestfish</span></code> æ£€æŸ¥(inspection)<a class="headerlink" href="#guestfish-inspection" title="Link to this heading">ïƒ</a></h4>
<p>é™¤äº†æ‰‹å·¥åˆ—å‡ºå’ŒæŒ‚è½½æ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥å¯ä»¥ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">guestfish</span></code> è‡ªèº«æ£€æŸ¥é•œåƒå’ŒæŒ‚è½½æ–‡ä»¶ç³»ç»Ÿï¼Œå°±åƒæ˜¯åœ¨guestè™šæ‹Ÿæœºå†…éƒ¨æ“ä½œä¸€æ ·ã€‚è¦å®ç°æ£€æŸ¥ï¼Œåœ¨å‘½ä»¤è¡Œæ·»åŠ ä¸€ä¸ª <code class="docutils literal notranslate"><span class="pre">-i</span></code> å‚æ•°ï¼š</p>
<blockquote>
<div><p>guestfish --ro -a /var/lib/libvirt/images/centos6.img -i</p>
</div></blockquote>
<p>è¿™é‡Œå’Œæ²¡æœ‰ <code class="docutils literal notranslate"><span class="pre">-i</span></code> å‚æ•°çš„æƒ…å†µç›¸æ¯”ï¼Œå¤šäº†ä»¥ä¸‹æç¤º:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Operating</span> <span class="n">system</span><span class="p">:</span> <span class="n">CentOS</span> <span class="n">release</span> <span class="mf">6.9</span> <span class="p">(</span><span class="n">Final</span><span class="p">)</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vg_centos6</span><span class="o">/</span><span class="n">lv_root</span> <span class="n">mounted</span> <span class="n">on</span> <span class="o">/</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda1</span> <span class="n">mounted</span> <span class="n">on</span> <span class="o">/</span><span class="n">boot</span>

<span class="o">&gt;&lt;</span><span class="n">fs</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>æ­¤æ—¶ç£ç›˜é•œåƒå·²ç»å’Œguestè™šæ‹Ÿæœºå†…éƒ¨ä¸€æ ·æŒ‚è½½å¥½äº†æ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥ç›´æ¥æ£€æŸ¥ <code class="docutils literal notranslate"><span class="pre">/</span></code> å°±ç›¸å½“äºæ£€æŸ¥guestè™šæ‹Ÿæœºå†…éƒ¨çš„ <code class="docutils literal notranslate"><span class="pre">/</span></code> æ–‡ä»¶ç³»ç»Ÿ:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&lt;</span><span class="n">fs</span><span class="o">&gt;</span> <span class="n">ll</span> <span class="o">/</span>
<span class="n">total</span> <span class="mi">114</span>
<span class="n">dr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="mi">22</span> <span class="n">root</span> <span class="n">root</span>  <span class="mi">4096</span> <span class="n">Apr</span> <span class="mi">14</span> <span class="mi">04</span><span class="p">:</span><span class="mi">07</span> <span class="o">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">19</span> <span class="n">root</span> <span class="n">root</span>  <span class="mi">4096</span> <span class="n">Apr</span> <span class="mi">18</span> <span class="mi">01</span><span class="p">:</span><span class="mi">59</span> <span class="o">..</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>     <span class="mi">0</span> <span class="n">Apr</span> <span class="mi">14</span> <span class="mi">04</span><span class="p">:</span><span class="mi">07</span> <span class="o">.</span><span class="n">autofsck</span>
<span class="n">dr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">2</span> <span class="n">root</span> <span class="n">root</span>  <span class="mi">4096</span> <span class="n">Apr</span> <span class="mi">11</span> <span class="mi">14</span><span class="p">:</span><span class="mi">00</span> <span class="nb">bin</span>
<span class="n">dr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">5</span> <span class="n">root</span> <span class="n">root</span>  <span class="mi">1024</span> <span class="n">Apr</span> <span class="mi">11</span> <span class="mi">12</span><span class="p">:</span><span class="mi">59</span> <span class="n">boot</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">2</span> <span class="n">root</span> <span class="n">root</span>  <span class="mi">4096</span> <span class="n">Apr</span> <span class="mi">11</span> <span class="mi">12</span><span class="p">:</span><span class="mi">54</span> <span class="n">dev</span>
<span class="o">...</span>
</pre></div>
</div>
<p>ç”±äº <code class="docutils literal notranslate"><span class="pre">guestfish</span></code> éœ€è¦å¯åŠ¨ <code class="docutils literal notranslate"><span class="pre">libguestfs</span></code> åç«¯æ¥æ‰§è¡Œæ£€æŸ¥å’ŒæŒ‚è½½ï¼Œæ‰€ä»¥å½“ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">-i</span></code> çš„æ—¶å€™ä¸å†éœ€è¦æ‰§è¡Œ <code class="docutils literal notranslate"><span class="pre">run</span></code> å‘½ä»¤ã€‚è¿™ä¸ª <code class="docutils literal notranslate"><span class="pre">-i</span></code> å‚æ•°å¯ä»¥ç”¨äºå¤§å¤šæ•°å¸¸ç”¨Linux guestè™šæ‹Ÿæœºã€‚</p>
</section>
<section id="guest">
<h4>é€šè¿‡åå­—è®¿é—®guestè™šæ‹Ÿæœº<a class="headerlink" href="#guest" title="Link to this heading">ïƒ</a></h4>
<p>guestè™šæ‹Ÿæœºå¯ä»¥é€šè¿‡æŒ‡å®šå’Œlibvirtç›¸åŒè™šæ‹Ÿæœºåå­—çš„å‘½ä»¤æ¥è®¿é—®ï¼ˆä¹Ÿå°±æ˜¯é€šè¿‡ <code class="docutils literal notranslate"><span class="pre">virsh</span> <span class="pre">list</span> <span class="pre">--all</span></code> æŸ¥çœ‹çš„è™šæ‹Ÿæœºåå­—ï¼‰ã€‚ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">-d</span></code> å‚æ•°æ¥é€šè¿‡è™šæ‹Ÿæœºåå­—è®¿é—®ç£ç›˜è®¾å¤‡ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">-i</span></code> é€‰é¡¹ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">guestfish</span> <span class="o">--</span><span class="n">ro</span> <span class="o">-</span><span class="n">d</span> <span class="n">centos6</span> <span class="o">-</span><span class="n">i</span>
</pre></div>
</div>
<p>ä¸Šè¿°é€šè¿‡æŒ‡å®šè™šæ‹Ÿæœºåå­—æ–¹æ³•è®¿é—®è™šæ‹Ÿæœºç£ç›˜å¯ä»¥ç›´æ¥ç­‰åŒå¯åŠ¨è™šæ‹Ÿæœºè®¿é—®ç£ç›˜æ–‡ä»¶ç³»ç»Ÿã€‚</p>
</section>
<section id="id4">
<h4>ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">guestfish</span></code> æ·»åŠ æ–‡ä»¶<a class="headerlink" href="#id4" title="Link to this heading">ïƒ</a></h4>
<p>è¦ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">guestfish</span></code> æ·»åŠ ä¸€ä¸ªæ–‡ä»¶ï¼Œéœ€è¦ä½¿ç”¨å®Œæ•´çš„URIã€‚è¢«è®¿é—®çš„è™šæ‹Ÿæœºç£ç›˜æ–‡ä»¶å¿…é¡»æ˜¯æœ¬åœ°æ–‡ä»¶ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªç½‘ç»œå—è®¾å¤‡ï¼ˆNBDï¼‰æˆ–è€…ä¸€ä¸ªè¿œç¨‹å—è®¾å¤‡(RBD) ( <a class="reference internal" href="../ceph/rbd/index.html#ceph-rbd"><span class="std std-ref">Ceph Block Device(RBD)</span></a> )ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›URIä¾‹å­ï¼Œå¯¹äºæœ¬åœ°æ–‡ä»¶ï¼Œä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">///</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>guestfish -a disk.img
guestfish -a file:///directory/disk.img
guestfish -a nbd://example.com[:port]
guestfish -a nbd://example.com[:port]/exportname
guestfish -a nbd://?socket=/socket
guestfish -a nbd:///exportname?socket=/socket
guestfish -a rbd:///pool/disk
guestfish -a rbd://example.com[:port]/pool/disk
</pre></div>
</div>
<p>å¯¹äº <a class="reference internal" href="../ceph/rbd/ceph_rbd_libvirt.html#ceph-rbd-libvirt"><span class="std std-ref">Libvirté›†æˆCeph RBD</span></a> ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ libvirt domain ï¼Œæ’å…¥æ–‡ä»¶ (ä»¥ä¸‹æ¡ˆä¾‹å¯å‚è€ƒï¼Œå¯¹äºä¸åŒè™šæ‹Ÿæœºéƒ½å¯ä»¥æ¨¡ä»¿ä½¿ç”¨)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">guestfish</span> <span class="o">--</span><span class="n">rw</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">d</span> <span class="n">ceph</span><span class="o">-</span><span class="n">rbd</span><span class="o">-</span><span class="n">win08</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">x</span> <span class="n">upload</span> <span class="o">/</span><span class="n">chost</span><span class="o">/</span><span class="n">guest</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="n">ceph</span><span class="o">-</span><span class="n">fs</span><span class="o">/</span><span class="n">cloudvminit_full</span> <span class="o">/</span><span class="n">cloudvminit</span><span class="o">.</span><span class="n">bat</span>
</pre></div>
</div>
</section>
<section id="id5">
<h4>ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">guestfish</span></code> ä¿®æ”¹æ–‡ä»¶<a class="headerlink" href="#id5" title="Link to this heading">ïƒ</a></h4>
<p>è¦é’ˆå¯¹ä¸€ä¸ªguestè™šæ‹Ÿæœºä¿®æ”¹æ–‡ä»¶ï¼Œåˆ›å»ºç›®å½•æˆ–è€…å…¶ä»–ä¿®æ”¹ï¼Œé¦–å…ˆå¿…é¡»ç¡®ä¿è™šæ‹Ÿæœºæ˜¯å…³é—­çŠ¶æ€çš„ã€‚</p>
<p>ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">guestfish</span></code> ç¼–è¾‘æˆ–ä¿®æ”¹è¿è¡Œä¸­çš„ç£ç›˜å°†å¯¼è‡´ç£ç›˜æŸåã€‚å½“ç¡®å®šäº†guestè™šæ‹Ÿæœºå·²ç»å…³é—­ï¼Œåˆ™å¯ä»¥ä¸ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">--ro</span></code> å‚æ•°:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">guestfish</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">d</span> <span class="n">centos6</span>
</pre></div>
</div>
<p>æ­¤æ—¶å¯ä»¥ç›´æ¥ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">vi</span></code> æ¥ç¼–è¾‘ä¿®æ”¹æ–‡ä»¶</p>
<div class="admonition note">
<p class="admonition-title">å¤‡æ³¨</p>
<p><code class="docutils literal notranslate"><span class="pre">guestfish</span> <span class="pre">-d</span></code> ä¼šè‡ªåŠ¨åˆ†æè™šæ‹Ÿæœºçš„ç£ç›˜å¹¶è¿è¡Œä¸€ä¸ªå¾®å‹å†…æ ¸è™šæ‹Ÿæœºæ¥æŒ‚è½½è™šæ‹Ÿæœºç£ç›˜ï¼Œè¿™å¯¹ä¿®æ”¹(ä¿®å¤)è™šæ‹Ÿæœºç£ç›˜é—®é¢˜éå¸¸æœ‰å¸®åŠ©ï¼Œä¹Ÿæ˜¯å¤§è§„æ¨¡cloneè™šæ‹Ÿæœºçš„å¿…å¤‡æ‰‹æ®µã€‚</p>
<p>æˆ‘å®è·µéªŒè¯ï¼Œ <code class="docutils literal notranslate"><span class="pre">guestfish</span> <span class="pre">-d</span></code> å¯ä»¥ç›´æ¥å¯¹ <a class="reference internal" href="../ceph/rbd/ceph_rbd_libvirt.html#ceph-rbd-libvirt"><span class="std std-ref">Libvirté›†æˆCeph RBD</span></a> è™šæ‹Ÿæœºçš„ Ceph RBD ç£ç›˜è¿›è¡Œä¿®è®¢ï¼Œæ‰€ä»¥åœ¨ <a class="reference internal" href="../ceph/rbd/clone_vm_rbd.html#clone-vm-rbd"><span class="std std-ref">Cloneä½¿ç”¨Ceph RBDçš„è™šæ‹Ÿæœº</span></a> æˆ‘ç¼–å†™äº†ç®€å•çš„è„šæœ¬æ¥å¤„ç†è™šæ‹Ÿæœºcloneã€‚</p>
</div>
</section>
</section>
</section>
<section id="id6">
<h2>å‚è€ƒ<a class="headerlink" href="#id6" title="Link to this heading">ïƒ</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Virtualization_Deployment_and_Administration_Guide/sect-Troubleshooting-libguestfs_troubleshooting.html">libguestfs Troubleshooting</a></p></li>
<li><p><a class="reference external" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/5/html/Virtualization/sect-Virtualization-Troubleshooting_Xen-Accessing_data_on_guest_disk_image.html">RHEL 5 Virtualization Guide: Accessing data from a guest disk image</a> - RHEL 5æ–‡æ¡£å…³äºç¦»çº¿ä¿®æ”¹guestæ–‡ä»¶ç³»ç»Ÿ</p></li>
<li><p><a class="reference external" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Administration_Guide/chap-Virtualization_Administration_Guide-Guest_Disks_libguestfs.html">RHEL 6 Virtualization Administration Guide: Guest Virtual Machine Disk Access with Offline Tools</a> - RHEL 6æ–‡æ¡£ å…³äºç¦»çº¿ä¿®æ”¹guestç£ç›˜</p></li>
<li><p><a class="reference external" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Virtualization_Deployment_and_Administration_Guide/chap-Guest_virtual_machine_disk_access_with_offline_tools.html">RHEL 7 Virtualization Deployment and Administration Guide: Guest Virtual Machine Disk Access with Offline Tools</a> - RHEL 7æ–‡æ¡£ å…³äºç¦»çº¿ä¿®æ”¹guestç£ç›˜</p></li>
<li><p><a class="reference external" href="https://dnaeon.github.io/resizing-a-kvm-disk-image-on-lvm-the-easy-way/">Resizing a QEMU KVM Linux image using virt-resize in CentOS 6.4</a></p></li>
<li><p><a class="reference external" href="https://rwmj.wordpress.com/2010/09/27/virt-resize-shrink-now-works/">virt-resize â€“shrink now works</a></p></li>
<li><p><a class="reference external" href="https://fatmin.com/2016/12/20/how-to-resize-a-qcow2-image-and-filesystem-with-virt-resize/">How to Resize a qcow2 Image and Filesystem with Virt-Resize</a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="é¡µè„š">
        <a href="qemu/qemu_docker_tesla_t10.html" class="btn btn-neutral float-left" title="åŸºäºQEMU+Dockerä½¿ç”¨Tesla T10" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> ä¸Šä¸€é¡µ</a>
        <a href="gpu_passthrough_with_kvm.html" class="btn btn-neutral float-right" title="KVMçš„GPUç›´é€šè™šæ‹ŸåŒ–" accesskey="n" rel="next">ä¸‹ä¸€é¡µ <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../copyright.html">ç‰ˆæƒæ‰€æœ‰</a> 2018 - now, Huatai Huangã€‚</p>
  </div>

  åˆ©ç”¨ <a href="https://www.sphinx-doc.org/">Sphinx</a> æ„å»ºï¼Œä½¿ç”¨çš„ 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">ä¸»é¢˜</a>
    ç”± <a href="https://readthedocs.org">Read the Docs</a> å¼€å‘.
  
    <!-- your html code here -->
    <br>
    <p><a href="https://github.com/huataihuang/cloud-atlas/issues">ç•™è¨€å’Œè®¨è®º</a>|<a href="https://github.com/huataihuang/cloud-atlas/blob/master/source/donate.rst">è¯·æˆ‘å–ä¸€æ¯å’–å•¡ ğŸ‘ˆ</a></p>
    <br>
    <p>ç½‘ç«™é‡‡ç”¨ <a href="https://utteranc.es/">utterances</a> è¯„è®ºç³»ç»Ÿï¼Œæ‰€æœ‰è¯„è®ºå­˜å‚¨åœ¨<a href="https://github.com/huataihuang/cloud-atlas/issues">GitHub issues</a> ä¸­ï¼Œå¦‚æœä½ çœ‹ä¸åˆ°ä¸‹æ–¹çš„è¯„è®ºæ¡†ï¼Œé‚£ä¹ˆå¯èƒ½éœ€è¦<a href="https://cloud-atlas.readthedocs.io/zh-cn/latest/linux/security/vpn/index.html">è‡ªå¤‡æ¢¯å­</a> ğŸ‘ˆ</p>
    <div class="articleComments">
        <comments>
  <script src="https://utteranc.es/client.js"
    repo="huataihuang/cloud-atlas"
    issue-term="pathname"
    theme="github-light"
    crossorigin="anonymous"
    async>
  </script>
</comments>
    </div>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>